{"version":3,"file":"signStore.js","sources":["stores/signStore.js"],"sourcesContent":["// stores/signStore.js\nimport { defineStore } from 'pinia';\nimport { ref, computed } from 'vue';\n\nexport const useSignStore = defineStore('sign', () => {\n  \n  // 获取今天的日期字符串 YYYY-MM-DD\n  const getTodayString = () => {\n    const now = new Date();\n    const year = now.getFullYear();\n    const month = (now.getMonth() + 1).toString().padStart(2, '0');\n    const day = now.getDate().toString().padStart(2, '0');\n    return `${year}-${month}-${day}`;\n  };\n\n  // State: 读取本地缓存\n  const signDays = ref(uni.getStorageSync('sign_days') || 0); // 总签到天数\n  const lastSignDate = ref(uni.getStorageSync('sign_last_date') || ''); // 上次签到日期\n\n  // Getter: 判断今天是否已签到\n  const isSigned = computed(() => {\n    return lastSignDate.value === getTodayString();\n  });\n\n  // Getter: 格式化日期显示\n  const formattedDate = computed(() => {\n    return getTodayString();\n  });\n\n  // Action: 签到逻辑\n  const handleCheckIn = () => {\n    if (isSigned.value) return false; // 今天已签到，不执行\n\n    // 更新数据\n    signDays.value += 1;\n    lastSignDate.value = getTodayString();\n\n    // 存入本地缓存 (持久化)\n    uni.setStorageSync('sign_days', signDays.value);\n    uni.setStorageSync('sign_last_date', lastSignDate.value);\n\n    return true;\n  };\n\n  return {\n    signDays,\n    isSigned,\n    formattedDate,\n    handleCheckIn\n  };\n});"],"names":["defineStore","ref","uni","computed"],"mappings":";;AAIY,MAAC,eAAeA,cAAAA,YAAY,QAAQ,MAAM;AAGpD,QAAM,iBAAiB,MAAM;AAC3B,UAAM,MAAM,oBAAI;AAChB,UAAM,OAAO,IAAI;AACjB,UAAM,SAAS,IAAI,aAAa,GAAG,SAAQ,EAAG,SAAS,GAAG,GAAG;AAC7D,UAAM,MAAM,IAAI,QAAS,EAAC,SAAQ,EAAG,SAAS,GAAG,GAAG;AACpD,WAAO,GAAG,IAAI,IAAI,KAAK,IAAI,GAAG;AAAA,EAClC;AAGE,QAAM,WAAWC,cAAAA,IAAIC,cAAG,MAAC,eAAe,WAAW,KAAK,CAAC;AACzD,QAAM,eAAeD,cAAAA,IAAIC,cAAG,MAAC,eAAe,gBAAgB,KAAK,EAAE;AAGnE,QAAM,WAAWC,cAAAA,SAAS,MAAM;AAC9B,WAAO,aAAa,UAAU;EAClC,CAAG;AAGD,QAAM,gBAAgBA,cAAAA,SAAS,MAAM;AACnC,WAAO,eAAc;AAAA,EACzB,CAAG;AAGD,QAAM,gBAAgB,MAAM;AAC1B,QAAI,SAAS;AAAO,aAAO;AAG3B,aAAS,SAAS;AAClB,iBAAa,QAAQ;AAGrBD,kBAAAA,MAAI,eAAe,aAAa,SAAS,KAAK;AAC9CA,kBAAAA,MAAI,eAAe,kBAAkB,aAAa,KAAK;AAEvD,WAAO;AAAA,EACX;AAEE,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACJ;AACA,CAAC;;"}