{"version":3,"file":"learn.js","sources":["pages-chat/learn/learn.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMtY2hhdFxsZWFyblxsZWFybi52dWU"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <view v-if=\"loading\">Âä†ËΩΩÂçïËØç‰∏≠...</view>\n\n    <view v-else-if=\"currentWord\" class=\"card\">\n      <text class=\"word\">{{ currentWord.word }}</text>\n      <text class=\"phonetic\">/{{ currentWord.phonetic }}/</text>\n      \n      <view class=\"definition-box\">\n        <text v-if=\"showDefinition\" class=\"definition\">{{ currentWord.translation }}</text>\n        <view v-else class=\"mask\" @click=\"showDefinition = true\">ÁÇπÂáªÊü•ÁúãÈáä‰πâ</view>\n      </view>\n\n      <view class=\"action-area\" v-if=\"showDefinition\">\n        <button type=\"warn\" @click=\"handleResult(0)\">‰∏çËÆ§ËØÜ (ÈôåÁîü)</button>\n        <button type=\"primary\" @click=\"handleResult(1)\">ËÆ§ËØÜ (Â∑≤ÊéåÊè°)</button>\n      </view>\n    </view>\n\n    <view v-else>\n      <text>‰ªäÊó•‰ªªÂä°Â∑≤ÂÆåÊàêÔºÅüéâ</text>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\n\nconst db = uniCloud.database()\nconst currentWord = ref(null)\nconst showDefinition = ref(false)\nconst loading = ref(true)\n\n// 1. Ëé∑Âèñ‰∏Ä‰∏™‚ÄúÊàëÊ≤°ËÉåËøá‚ÄùÊàñËÄÖ‚ÄúËØ•Â§ç‰π†‚ÄùÁöÑÂçïËØç\nconst fetchNextWord = async () => {\n  loading.value = true\n  showDefinition.value = false\n  \n  try {\n    // ÈÄªËæë AÔºöÂÖàÊü•ËÆ∞ÂΩïË°®ÔºåÊâæËØ•Â§ç‰π†ÁöÑËØçÔºàËøôÈáåÁÆÄÂåñ‰∏∫ÂÖàÂè™ÊâæÊñ∞ËØçÔºâ\n    // ÂÆûÈôÖÈ°πÁõÆ‰∏≠ÔºåËøôÈáåÂ∫îËØ•ÂÖàÊü•ËØ¢ user_word_records Ë°®\n    \n    // ÈÄªËæë BÔºöÂ¶ÇÊûúÊ≤°ÊúâËØ•Â§ç‰π†ÁöÑÔºåÂ∞±‰ªé dict_cet4 ÈöèÊú∫Êãø‰∏Ä‰∏™Ê≤°ËÉåËøáÁöÑ\n    // ‰ΩøÁî® JQL ÁöÑËÅîË°®Êü•ËØ¢Êàñ‰∏¥Êó∂Ë°®ÊñπÊ°àÔºàËøôÈáåÊºîÁ§∫ÊúÄÁÆÄÂçïÁöÑÈöèÊú∫ÊäΩÂèñÊñπÊ°àÔºâ\n    const res = await db.collection('dict_cet4')\n      .limit(1)\n      .get({ getOne: true }) // ÈöèÊú∫Ëé∑Âèñ‰∏Ä‰∏™ÔºåÂÆûÈôÖÈúÄÈÖçÂêà .sample() Êàñ skip\n      \n    // *Ê≥®ÊÑèÔºöÁúüÂÆûÂú∫ÊôØÈúÄËøáÊª§Êéâ user_word_records ‰∏≠Â∑≤Â≠òÂú®ÁöÑ word_id*\n    \n    if (res.result.data) {\n      currentWord.value = res.result.data\n    } else {\n      currentWord.value = null\n    }\n  } catch (e) {\n    console.error('Ëé∑ÂèñÂ§±Ë¥•', e)\n    uni.showToast({ title: 'ÁΩëÁªúÈîôËØØ', icon: 'none' })\n  } finally {\n    loading.value = false\n  }\n}\n\n// 2. Êèê‰∫§Â≠¶‰π†ÁªìÊûú\nconst handleResult = async (status) => {\n  // status: 0 (‰∏çËÆ§ËØÜ), 1 (ËÆ§ËØÜ)\n  \n  // ÁÆÄÂçïÁÆóÊ≥ïÔºöÂ¶ÇÊûúÊòØ‚Äú‰∏çËÆ§ËØÜ‚ÄùÔºå‰∏ãÊ¨°Â§ç‰π†Êó∂Èó¥ÊòØ 5 ÂàÜÈíüÂêéÔºõ‚ÄúËÆ§ËØÜ‚ÄùÂàôÊòØ 1 Â§©Âêé\n  const nextReview = status === 0 ? Date.now() + 300000 : Date.now() + 86400000\n  \n  try {\n    // ÂÜôÂÖ•ÊàñÊõ¥Êñ∞‰∫ëÁ´ØÊï∞ÊçÆÂ∫ì\n    await db.collection('user_word_records').add({\n      word_id: currentWord.value._id,\n      status: status,\n      next_review_time: nextReview,\n      create_date: Date.now()\n    })\n    \n    uni.showToast({ title: status === 1 ? 'Â§™Ê£í‰∫Ü' : 'ÁªßÁª≠Âä†Ê≤π', icon: 'none' })\n    \n    // Ëá™Âä®Ë∑≥‰∏ã‰∏Ä‰∏™\n    fetchNextWord()\n    \n  } catch (e) {\n    console.error('‰øùÂ≠òËøõÂ∫¶Â§±Ë¥•', e)\n  }\n}\n\nonMounted(() => {\n  fetchNextWord()\n})\n</script>\n\n<style>\n/* ÁÆÄÂçïÁöÑÊ†∑Âºè */\n.container { padding: 40px; text-align: center; }\n.word { font-size: 40px; font-weight: bold; display: block; margin-bottom: 10px; }\n.phonetic { color: #666; font-family: monospace; display: block; margin-bottom: 30px; }\n.mask { background: #eee; padding: 20px; color: #999; border-radius: 8px; }\n.action-area { margin-top: 40px; display: flex; gap: 20px; }\n</style>","import MiniProgramPage from 'C:/Users/ffx/OneDrive/Desktop/È°πÁõÆÊ∫êÁ†Å/xuedong-uniapp/pages-chat/learn/learn.vue'\nwx.createPage(MiniProgramPage)"],"names":["uniCloud","ref","uni","onMounted","MiniProgramPage"],"mappings":";;;;;AA4BA,UAAM,KAAKA,cAAQ,GAAC,SAAU;AAC9B,UAAM,cAAcC,cAAG,IAAC,IAAI;AAC5B,UAAM,iBAAiBA,cAAG,IAAC,KAAK;AAChC,UAAM,UAAUA,cAAG,IAAC,IAAI;AAGxB,UAAM,gBAAgB,YAAY;AAChC,cAAQ,QAAQ;AAChB,qBAAe,QAAQ;AAEvB,UAAI;AAMF,cAAM,MAAM,MAAM,GAAG,WAAW,WAAW,EACxC,MAAM,CAAC,EACP,IAAI,EAAE,QAAQ,MAAM;AAIvB,YAAI,IAAI,OAAO,MAAM;AACnB,sBAAY,QAAQ,IAAI,OAAO;AAAA,QACrC,OAAW;AACL,sBAAY,QAAQ;AAAA,QACrB;AAAA,MACF,SAAQ,GAAG;AACVC,sBAAAA,MAAA,MAAA,SAAA,oCAAc,QAAQ,CAAC;AACvBA,sBAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,QAAQ;AAAA,MACjD,UAAY;AACR,gBAAQ,QAAQ;AAAA,MACjB;AAAA,IACH;AAGA,UAAM,eAAe,OAAO,WAAW;AAIrC,YAAM,aAAa,WAAW,IAAI,KAAK,IAAK,IAAG,MAAS,KAAK,IAAG,IAAK;AAErE,UAAI;AAEF,cAAM,GAAG,WAAW,mBAAmB,EAAE,IAAI;AAAA,UAC3C,SAAS,YAAY,MAAM;AAAA,UAC3B;AAAA,UACA,kBAAkB;AAAA,UAClB,aAAa,KAAK,IAAK;AAAA,QAC7B,CAAK;AAEDA,4BAAI,UAAU,EAAE,OAAO,WAAW,IAAI,QAAQ,QAAQ,MAAM,QAAQ;AAGpE,sBAAe;AAAA,MAEhB,SAAQ,GAAG;AACVA,sBAAAA,MAAA,MAAA,SAAA,oCAAc,UAAU,CAAC;AAAA,MAC1B;AAAA,IACH;AAEAC,kBAAAA,UAAU,MAAM;AACd,oBAAe;AAAA,IACjB,CAAC;;;;;;;;;;;;;;;;;;;;;;;AC1FD,GAAG,WAAWC,SAAe;"}